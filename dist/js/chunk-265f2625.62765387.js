(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-265f2625"],{1070:function(e,t,s){"use strict";var a=s("9bf9"),r=s.n(a);r.a},"11e0":function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"chat-container"},[s("v-container",{staticClass:"chat-wrapper"},[s("v-row",{attrs:{"no-gutters":""}},[s("v-col",{staticClass:"pa-2",attrs:{cols:"12"}},[s("div",{staticClass:"chat-header"},[s("router-link",{staticClass:"user-link",attrs:{to:"/user/"+e.receiverId}},[s("v-avatar",{staticClass:"mr-2",attrs:{size:"40"}},[s("v-img",{attrs:{src:e.urls+"/profile-image/"+e.$route.params.receiverID+".PNG"||!1}})],1),s("h1",{staticClass:"head"},[e._v(e._s(e.receiverName))])],1),s("v-btn",{staticClass:"encryption-btn",attrs:{icon:"",to:"/encr-private-chat/"+e.$route.params.receiverID,title:"End-to-End Encryption"}},[s("v-icon",[e._v("mdi-lock")])],1)],1),s("main",{staticClass:"chat-main"},[s("section",{ref:"chatArea",staticClass:"chat-area"},[s("div",{staticClass:"messages-container"},e._l(e.messages,(function(t,a){return s("div",{key:t._id,class:{"message-container":!0,outgoing:"you"===t.author,incoming:"you"!==t.author}},[s("div",{staticClass:"message-bubble",class:{outgoing:"you"===t.author,incoming:"you"!==t.author,seen:"seen"===t.status,sent:"sent"===t.status,deleted:t.deletearray.length>0},on:{click:function(t){return e.toggleVisibilityButtons(a)}}},[e._v(" "+e._s(t.body)+" "),s("div",{staticClass:"message-meta"},[s("span",{staticClass:"time"}),"you"!=t.author?s("v-icon",{attrs:{small:"",color:"seen"===t.status?"blue":"grey"}},[e._v(" "+e._s("seen"===t.status?"mdi-check-all":"mdi-check")+" ")]):e._e()],1)]),e.visibleButtons[a]?s("div",{staticClass:"message-actions"},[s("v-btn",{attrs:{icon:"",small:""},on:{click:function(s){return e.deleteRestoreMessage(t._id,a)}}},[s("v-icon",{attrs:{color:t.deletearray.includes(e.userID)?"blue":t.deletearray.length>0?"red":"blue"}},[e._v(" "+e._s(t.deletearray.includes(e.userID)?"mdi-restore":"mdi-delete")+" ")])],1)],1):e._e()])})),0)]),s("section",{staticClass:"message-input"},[s("v-form",{staticClass:"input-form",on:{submit:function(t){return t.preventDefault(),e.sendMessage(t)}}},[s("v-text-field",{staticClass:"message-field",attrs:{placeholder:"Type your message...",outlined:"",dense:"","hide-details":"","append-icon":"mdi-send"},on:{"click:append":e.sendMessage},model:{value:e.bobMessage,callback:function(t){e.bobMessage=t},expression:"bobMessage"}})],1)],1)])])],1)],1)],1)},r=[],o=(s("99af"),s("4de4"),s("7db0"),s("d81d"),s("a434"),s("b0c0"),s("5530")),i=s("db49"),n=s("8055"),c=s.n(n),u=s("2f62"),l=s("6e87"),d=s("bc3a"),h=s.n(d),m={data:function(){return{socket:c()(i["a"],{query:{token:localStorage.getItem("token")}}),bobMessage:"",youMessage:"",receiverName:"",receiverId:this.$route.params.receiverID,messages:[],windowWidth2:window.innerWidth,visibleButtons:[],userID:localStorage.getItem("userID"),urls:i["a"]}},methods:Object(o["a"])({sendMessage:function(){try{this.$store.dispatch("socketOnConnection",{msg:this.bobMessage,id:this.$route.params.receiverID}),this.$store.dispatch("getUserSearchPic",this.$route.params.id)}catch(e){console.log("the error heree")}this.$nextTick((function(){document.getElementsByClassName("chat-area")[0].scrollTop}))},onResize:function(){console.log("App.vue-onResize()",this.windowWidth2),this.windowWidth2=window.innerWidth},toggleVisibilityButtons:function(e){this.$set(this.visibleButtons,e,!this.visibleButtons[e]),console.log(this.visibleButtons),console.log(this.messages[e])},deleteRestoreMessage:function(e,t){var s=this;console.log("message id is: ",e),h.a.post(this.urls+"/chat-message/delete-msg",{id:e,receiverID:this.$route.params.receiverID},{headers:{authorization:localStorage.getItem("token")}}).then((function(a){if(a.data.success){if(console.log("eee",a),"message confirm delete"==a.data.message&&(s.messages.splice(t,1),s.visibleButtons.splice(t,1)),"message delete request"==a.data.message){var r=s.messages.find((function(t){return t._id===e}));r&&r.deletearray.push(localStorage.getItem("userID"))}if("message restore"==a.data.message){var o=s.messages.find((function(t){return t._id===e}));o&&(o.deletearray=[])}}console.log(a)}))}},Object(u["b"])({getChatMessage:l["i"]})),computed:Object(o["a"])({},Object(u["c"])({getMessages:l["i"]})),watch:{windowWidth2:function(e,t){var s="it changed to ".concat(t," from ").concat(e);console.log("sxxx",s)}},created:function(){var e=this;h.a.get(this.urls+"/chat-message/"+this.$route.params.receiverID,{headers:{authorization:localStorage.getItem("token")}}).then((function(t){console.log("msgd22",t.data);var s=t.data;s.map((function(t){return t.from==localStorage.getItem("userID")?(console.log("0000",localStorage.getItem("userID"),"0000",t.from),e.messages.push({body:t.text,author:"bob",_id:t._id,deletearray:t.delete,status:t.status}),e.$nextTick((function(){document.getElementsByClassName("chat-area")[0].scrollTop="1111111111111111111111111111"})),{body:t.text,author:"bob"}):(e.messages.push({body:t.text,author:"you",_id:t._id,deletearray:t.delete,status:t.status}),{body:t.text,author:"you"})})),console.log("444",e.messages)})),this.socket.on("msg",(function(t){t.senderId==localStorage.getItem("userID")?(console.log("ChatOneToOne new message 2026",t),e.messages.push({body:t.msg,author:"bob",deletearray:t.delete,_id:t._id,status:t.status}),e.$nextTick((function(){document.getElementsByClassName("chat-area")[0].scrollTop="1111111111111111111111111111"}))):t.senderId==e.$route.params.receiverID&&(console.log("ChatOneToOne new message 2025",t),e.messages.push({body:t.msg,author:"you",deletearray:t.delete,_id:t._id,status:t.status}),e.$nextTick((function(){document.getElementsByClassName("chat-area")[0].scrollTop="1111111111111111111111111111"})))})),this.socket.emit("current-url",this.$route.params.receiverID),this.socket.on("message_deleted_request",(function(t){console.log("message_deleted_request",t);var s=e.messages.find((function(e){return e._id===t.messageId}));s&&s.deletearray.push(e.$route.params.receiverID)})),this.socket.on("message_restore",(function(t){console.log("message_restore",t);var s=e.messages.find((function(e){return e._id===t.messageId}));s&&(s.deletearray=[])})),this.socket.on("message_delete_permenant",(function(t){console.log("message_deleted_permanent",t),e.messages=e.messages.filter((function(e){return e._id!==t.messageId}))})),this.socket.on("message-seen",(function(t){if(console.log("new sseenn",t),t==e.$route.params.receiverID){var s=e.messages.length-1;console.log("seen message all: ",t,"arryChatLength: ",s);for(var a=s;a>=0;a--)console.log("oooooooooooooo",a),"seen"==e.messages[a].status?console.log("eeeeerrrrrrr"):e.messages[a].status="seen"}})),h.a.post(this.urls+"/users/get-name-chat",{id:this.$route.params.receiverID},{headers:{authorization:localStorage.getItem("token")}}).then((function(t){e.receiverName=t.data.name})),this.$route.params.receiverID==localStorage.getItem("userID")&&this.$router.push("/"),h.a.post(this.urls+"/get-all-messages/read-message",{receiverId:this.$route.params.receiverID},{headers:{authorization:localStorage.getItem("token")}}).then((function(t){e.socket.emit("new-post",t)})),this.socket.emit("some","some"),h.a.post(this.urls+"/seen/see-all-message",{senderId:this.$route.params.receiverID},{headers:{authorization:localStorage.getItem("token")}}).then((function(e){console.log("seen result",e)}))},mounted:function(){var e=this;this.socket.emit("current-url",this.$route.params.receiverID),this.$nextTick((function(){window.addEventListener("resize",e.onResize),e.socket.emit("current-url",e.$route.params.receiverID)}))},updated:function(){this.socket.emit("current-url",this.$route.params.receiverID)},destroyed:function(){this.messages=[],this.$store.dispatch(l["v"]),this.socket.emit("current-url",null),window.removeEventListener("resize",this.onResize)}},g=m,f=(s("1070"),s("2877")),v=s("6544"),p=s.n(v),b=s("8212"),I=s("8336"),_=s("62ad"),y=s("a523"),w=s("4bd4"),k=s("132d"),$=s("adda"),C=s("0fd9"),D=s("8654"),B=Object(f["a"])(g,a,r,!1,null,"fdd7ed70",null);t["default"]=B.exports;p()(B,{VAvatar:b["a"],VBtn:I["a"],VCol:_["a"],VContainer:y["a"],VForm:w["a"],VIcon:k["a"],VImg:$["a"],VRow:C["a"],VTextField:D["a"]})},"4bd4":function(e,t,s){"use strict";s("4de4"),s("7db0"),s("4160"),s("caad"),s("07ac"),s("2532"),s("159b");var a=s("5530"),r=s("58df"),o=s("7e2b"),i=s("3206");t["a"]=Object(r["a"])(o["a"],Object(i["b"])("form")).extend({name:"v-form",provide:function(){return{form:this}},inheritAttrs:!1,props:{disabled:Boolean,lazyValidation:Boolean,readonly:Boolean,value:Boolean},data:function(){return{inputs:[],watchers:[],errorBag:{}}},watch:{errorBag:{handler:function(e){var t=Object.values(e).includes(!0);this.$emit("input",!t)},deep:!0,immediate:!0}},methods:{watchInput:function(e){var t=this,s=function(e){return e.$watch("hasError",(function(s){t.$set(t.errorBag,e._uid,s)}),{immediate:!0})},a={_uid:e._uid,valid:function(){},shouldValidate:function(){}};return this.lazyValidation?a.shouldValidate=e.$watch("shouldValidate",(function(r){r&&(t.errorBag.hasOwnProperty(e._uid)||(a.valid=s(e)))})):a.valid=s(e),a},validate:function(){return 0===this.inputs.filter((function(e){return!e.validate(!0)})).length},reset:function(){this.inputs.forEach((function(e){return e.reset()})),this.resetErrorBag()},resetErrorBag:function(){var e=this;this.lazyValidation&&setTimeout((function(){e.errorBag={}}),0)},resetValidation:function(){this.inputs.forEach((function(e){return e.resetValidation()})),this.resetErrorBag()},register:function(e){this.inputs.push(e),this.watchers.push(this.watchInput(e))},unregister:function(e){var t=this.inputs.find((function(t){return t._uid===e._uid}));if(t){var s=this.watchers.find((function(e){return e._uid===t._uid}));s&&(s.valid(),s.shouldValidate()),this.watchers=this.watchers.filter((function(e){return e._uid!==t._uid})),this.inputs=this.inputs.filter((function(e){return e._uid!==t._uid})),this.$delete(this.errorBag,t._uid)}}},render:function(e){var t=this;return e("form",{staticClass:"v-form",attrs:Object(a["a"])({novalidate:!0},this.attrs$),on:{submit:function(e){return t.$emit("submit",e)}}},this.$slots.default)}})},"9bf9":function(e,t,s){}}]);
//# sourceMappingURL=chunk-265f2625.62765387.js.map